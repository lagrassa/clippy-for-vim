import math
import util
from ranges import realRange, angleRange

ikNuggets = [
[(0.263254,0.559217), (6.208818,7.197906), (0.550000,0.750000), (5.497787,7.068583)],
[(0.200002,0.607586), (5.964438,6.857586), (0.650000,0.850000), (4.712389,6.283185)],
[(0.168723,0.535556), (5.010269,6.215432), (0.550000,0.850000), (3.926991,5.497787)], 
[(0.484907,0.780684), (0.132595,0.762792), (0.650000,0.950000), (5.497787,7.068583)],
[(0.513886,0.900255), (0.808062,1.249545), (0.650000,0.850000), (5.497787,7.068583)],
[(0.551218,0.832505), (1.027058,1.640858), (0.650000,0.850000), (0.785398,2.356194)]]
# ikNuggets = []

ikPosesAll = [
    (0.4000000059604645, 0.5009999871253967, 0.75, 0.0),
    (0.29999998211860657, 0.5009999871253967, 0.75, 0.0),
    (0.4000000059604645, 0.4009999930858612, 0.75, 0.0),
    (0.5, 0.3009999990463257, 0.75, 0.0),
    (0.19999998807907104, 0.5009999871253967, 0.75, 0.0),
    (0.29999998211860657, 0.4009999930858612, 0.75, 0.0),
    (0.29999998211860657, 0.6010000109672546, 0.75, 0.0),
    (0.4000000059604645, 0.3009999990463257, 0.75, 0.0),
    (0.5, 0.20099997520446777, 0.75, 0.0),
    (0.09999999403953552, 0.5009999871253967, 0.75, 0.0),
    # (0.19999998807907104, 0.4009999930858612, 0.75, 0.0),
    (0.19999998807907104, 0.6010000109672546, 0.75, 0.0),
    # (0.29999998211860657, 0.3009999990463257, 0.75, 0.0),
    (0.29999998211860657, 0.7009999752044678, 0.75, 0.0),
    (0.4000000059604645, 0.20099997520446777, 0.75, 0.0),
    (0.5, 0.10099998116493225, 0.75, 0.0),
    (0.09999999403953552, 0.6010000109672546, 0.75, 0.0),
    (0.19999998807907104, 0.7009999752044678, 0.75, 0.0),
    (0.4000000059604645, 0.10099998116493225, 0.75, 0.0),
    (-5.551115123125783e-17, 0.6010000109672546, 0.75, 0.0),
    (0.09999999403953552, 0.7009999752044678, 0.75, 0.0),
    (0.19999998807907104, 0.8009999990463257, 0.75, 0.0),
    #(0.29999998211860657, 0.10099998116493225, 0.75, 0.0),
    (0.4000000059604645, 0.0009999871253967285, 0.75, 0.0),
    (-0.10000002384185791, 0.6010000109672546, 0.75, 0.0),
    (-5.551115123125783e-17, 0.7009999752044678, 0.75, 0.0),
    (0.09999999403953552, 0.8009999990463257, 0.75, 0.0),
    #(0.29999998211860657, 0.0009999871253967285, 0.75, 0.0),
    (0.4000000059604645, -0.09900003671646118, 0.75, 0.0),
    (-0.19999998807907104, 0.6010000109672546, 0.75, 0.0),
    (-0.10000002384185791, 0.7009999752044678, 0.75, 0.0),
    (-5.551115123125783e-17, 0.8009999990463257, 0.75, 0.0),
    (0.29999998211860657, -0.09900003671646118, 0.75, 0.0),
    (0.4000000059604645, -0.19900000095367432, 0.75, 0.0),
    (-0.30000001192092896, 0.6010000109672546, 0.75, 0.0),
    (-0.19999998807907104, 0.7009999752044678, 0.75, 0.0),
    (-0.10000002384185791, 0.8009999990463257, 0.75, 0.0),
    (0.29999998211860657, -0.19900000095367432, 0.75, 0.0),
    (-0.30000001192092896, 0.7009999752044678, 0.75, 0.0),
    (-0.19999998807907104, 0.8009999990463257, 0.75, 0.0),
    (0.29999998211860657, -0.2990000247955322, 0.75, 0.0),
    (-0.3999999761581421, 0.7009999752044678, 0.75, 0.0),
    (-0.30000001192092896, 0.8009999990463257, 0.75, 0.0),
    (0.19999998807907104, -0.2990000247955322, 0.75, 0.0),
    (-0.3999999761581421, 0.8009999990463257, 0.75, 0.0),
        
    (0.4527207911014557, 0.6282792091369629, 0.75, -0.7853983044624329),
    (0.35272079706192017, 0.6282792091369629, 0.75, -0.7853983044624329),
    (0.4527207911014557, 0.5282792448997498, 0.75, -0.7853983044624329),
    (0.5527207851409912, 0.42827922105789185, 0.75, -0.7853983044624329),
    (0.25272080302238464, 0.6282792091369629, 0.75, -0.7853983044624329),
    (0.35272079706192017, 0.5282792448997498, 0.75, -0.7853983044624329),
    (0.35272079706192017, 0.7282792329788208, 0.75, -0.7853983044624329),
    (0.4527207911014557, 0.42827922105789185, 0.75, -0.7853983044624329),
    (0.5527207851409912, 0.3282792270183563, 0.75, -0.7853983044624329),
    (0.15272079408168793, 0.6282792091369629, 0.75, -0.7853983044624329),
    (0.25272080302238464, 0.5282792448997498, 0.75, -0.7853983044624329),
    (0.25272080302238464, 0.7282792329788208, 0.75, -0.7853983044624329),
    (0.35272079706192017, 0.42827922105789185, 0.75, -0.7853983044624329),
    (0.35272079706192017, 0.8282792568206787, 0.75, -0.7853983044624329),
    (0.4527207911014557, 0.3282792270183563, 0.75, -0.7853983044624329),
    (0.5527207851409912, 0.2282792180776596, 0.75, -0.7853983044624329),
    (0.0527208037674427, 0.6282792091369629, 0.75, -0.7853983044624329),
    (0.15272079408168793, 0.7282792329788208, 0.75, -0.7853983044624329),
    (0.25272080302238464, 0.8282792568206787, 0.75, -0.7853983044624329),
    (0.4527207911014557, 0.2282792180776596, 0.75, -0.7853983044624329),
    (-0.04727922007441521, 0.6282792091369629, 0.75, -0.7853983044624329),
    (0.0527208037674427, 0.7282792329788208, 0.75, -0.7853983044624329),
    (0.15272079408168793, 0.8282792568206787, 0.75, -0.7853983044624329),
    (0.35272079706192017, 0.2282792180776596, 0.75, -0.7853983044624329),
    (0.4527207911014557, 0.12827922403812408, 0.75, -0.7853983044624329),
    (-0.04727922007441521, 0.7282792329788208, 0.75, -0.7853983044624329),
    (0.0527208037674427, 0.8282792568206787, 0.75, -0.7853983044624329),
    (0.15272079408168793, 0.9282792210578918, 0.75, -0.7853983044624329),
    (0.35272079706192017, 0.12827922403812408, 0.75, -0.7853983044624329),
    (0.4527207911014557, 0.028279203921556473, 0.75, -0.7853983044624329),
    (-0.14727918803691864, 0.7282792329788208, 0.75, -0.7853983044624329),
    (-0.04727922007441521, 0.8282792568206787, 0.75, -0.7853983044624329),
    (0.0527208037674427, 0.9282792210578918, 0.75, -0.7853983044624329),
    (0.35272079706192017, 0.028279203921556473, 0.75, -0.7853983044624329),
    (0.4527207911014557, -0.07172076404094696, 0.75, -0.7853983044624329),
    (-0.24727921187877655, 0.7282792329788208, 0.75, -0.7853983044624329),
    (-0.14727918803691864, 0.8282792568206787, 0.75, -0.7853983044624329),
    (-0.04727922007441521, 0.9282792210578918, 0.75, -0.7853983044624329),
    (0.35272079706192017, -0.07172076404094696, 0.75, -0.7853983044624329),
    (-0.24727921187877655, 0.8282792568206787, 0.75, -0.7853983044624329),
    (0.35272079706192017, -0.17172078788280487, 0.75, -0.7853983044624329),
    (0.25272080302238464, -0.17172078788280487, 0.75, -0.7853983044624329),

    (0.4527207911014557, 0.37372076511383057, 0.75, 0.7853981852531433),
    (0.3527207672595978, 0.37372076511383057, 0.75, 0.7853981852531433),
    (0.4527207911014557, 0.27372077107429504, 0.75, 0.7853981852531433),
    (0.5527207851409912, 0.17372076213359833, 0.75, 0.7853981852531433),
    (0.25272077322006226, 0.37372076511383057, 0.75, 0.7853981852531433),
    (0.3527207672595978, 0.27372077107429504, 0.75, 0.7853981852531433),
    (0.3527207672595978, 0.4737207591533661, 0.75, 0.7853981852531433),
    (0.4527207911014557, 0.17372076213359833, 0.75, 0.7853981852531433),
    (0.5527207851409912, 0.07372075319290161, 0.75, 0.7853981852531433),
    (0.25272077322006226, 0.27372077107429504, 0.75, 0.7853981852531433),
    (0.25272077322006226, 0.4737207591533661, 0.75, 0.7853981852531433),
    (0.3527207672595978, 0.17372076213359833, 0.75, 0.7853981852531433),
    (0.3527207672595978, 0.5737207531929016, 0.75, 0.7853981852531433),
    (0.4527207911014557, 0.07372075319290161, 0.75, 0.7853981852531433),
    (0.5527207851409912, -0.026279237121343613, 0.75, 0.7853981852531433),
    (0.15272077918052673, 0.4737207591533661, 0.75, 0.7853981852531433),
    (0.25272077322006226, 0.5737207531929016, 0.75, 0.7853981852531433),
    (0.4527207911014557, -0.026279237121343613, 0.75, 0.7853981852531433),
    (0.15272077918052673, 0.5737207531929016, 0.75, 0.7853981852531433),
    (0.25272077322006226, 0.6737207770347595, 0.75, 0.7853981852531433),
    (0.3527207672595978, -0.026279237121343613, 0.75, 0.7853981852531433),
    (0.4527207911014557, -0.12627923488616943, 0.75, 0.7853981852531433),
    (0.05272078141570091, 0.5737207531929016, 0.75, 0.7853981852531433),
    (0.15272077918052673, 0.6737207770347595, 0.75, 0.7853981852531433),
    (0.3527207672595978, -0.12627923488616943, 0.75, 0.7853981852531433),
    (0.4527207911014557, -0.22627925872802734, 0.75, 0.7853981852531433),
    (-0.047279242426157, 0.5737207531929016, 0.75, 0.7853981852531433),
    (0.05272078141570091, 0.6737207770347595, 0.75, 0.7853981852531433),
    (0.3527207672595978, -0.22627925872802734, 0.75, 0.7853981852531433),
    (0.4527207911014557, -0.3262792229652405, 0.75, 0.7853981852531433),
    (-0.14727920293807983, 0.5737207531929016, 0.75, 0.7853981852531433),
    (-0.047279242426157, 0.6737207770347595, 0.75, 0.7853981852531433),
    (-0.24727922677993774, 0.5737207531929016, 0.75, 0.7853981852531433),
    (-0.14727920293807983, 0.6737207770347595, 0.75, 0.7853981852531433),
    (-0.3472791910171509, 0.5737207531929016, 0.75, 0.7853981852531433),
    (-0.24727922677993774, 0.6737207770347595, 0.75, 0.7853981852531433),
    (-0.3472791910171509, 0.6737207770347595, 0.75, 0.7853981852531433)]

ikPoses = [[],                          # n = 0
           [p for p in ikPosesAll if p[-1] == 0.0], # n = 1
           ikPosesAll]                              # n = 2 

gripperTip = util.Pose(0.18,0.0,0.0,0.0)

def setupNuggets(n=2):
    nuggets = [util.Pose(*p) for p in ikPoses[n]]
    for r in ikNuggets:
        ranges = [realRange(*r[0]), angleRange(*r[1]),
                  realRange(*r[2]), angleRange(*r[3])]
        nuggets.append(nugPose([r.middle() for r in ranges]))
    tipPoses = [n.compose(gripperTip).pose() for n in nuggets]
    return nuggets, tipPoses

def nugPose(coord):
    r,phi,z,theta = coord
    return util.Pose(r*math.cos(phi), r*math.sin(phi), z, theta)
